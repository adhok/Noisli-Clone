<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Eco-Focus | Bio-Dome</title>
    <link rel="stylesheet" href="style.css">
</head>

<body>

    <div class="bg-image"></div>

    <nav class="timer-bar">
        <div class="left-nav-group">
            <!-- Theme Toggle Slider -->
            <label class="switch">
                <input type="checkbox" id="theme-toggle-input" onchange="toggleTheme()">
                <span class="slider"></span>
            </label>

            <div class="timer-info">
                <div class="app-title">ECO-FOCUS | BIO-DOME</div>
                <div class="timer-label" id="timer-mode">System Focus</div>
                <div class="session-count" id="session-count-display"
                    style="font-size: 0.7rem; color: #00bcd4; margin-top: 5px; font-weight: bold; letter-spacing: 1px;">
                    TOTAL SESSIONS: 0</div>
            </div>
        </div>

        <div class="timer-display" id="time-display">25:00</div>

        <div class="timer-controls-group">
            <div class="timer-settings">
                <div class="setting-group">
                    <label class="setting-label">Work</label>
                    <input type="number" class="timer-input" id="work-duration" min="5" max="60" value="25"
                        onchange="updateWorkDuration(this.value)">
                </div>
                <div class="setting-group">
                    <label class="setting-label">Break</label>
                    <input type="number" class="timer-input" id="break-duration" min="1" max="60" value="5"
                        onchange="updateBreakDuration(this.value)">
                </div>
            </div>

            <div class="timer-controls">
                <button class="btn btn-primary" id="start-btn" onclick="toggleTimer()">Start</button>
                <button class="btn" onclick="resetTimer()">Reset</button>
                <button class="btn" id="mode-btn" onclick="switchMode()">Break</button>
            </div>
        </div>
    </nav>

    <div class="container">

        <div class="view-switcher">
            <button class="switch-btn active" id="btn-view-audio" onclick="setView('audio')">Soundboard</button>
            <button class="switch-btn" id="btn-view-game" onclick="setView('game')" disabled>
                üëæ Break Game <span id="game-lock-status" style="font-size:0.8em; margin-left:5px;">(Locked)</span>
            </button>
            <button class="switch-btn" id="btn-view-breathing" onclick="setView('breathing')" disabled>
                üßò Breathe
            </button>
            <button class="switch-btn" id="btn-view-stats" onclick="setView('stats')">
                üìä Statistics
            </button>
        </div>

        <div class="sound-grid" id="view-audio">

            <div class="sound-card" id="card-forest" onclick="toggleSound('forest', 'card-forest')">
                <div class="icon">üå≤</div>
                <div class="status-text">OFF</div>
                <div class="slider-wrapper" onclick="event.stopPropagation()">
                    <input type="range" min="0" max="1" step="0.01" value="0.5"
                        oninput="setVolume('forest', this.value)">
                </div>
                <audio id="forest" loop preload="auto" src="sounds/forest_sounds.mp3"></audio>
            </div>

            <div class="sound-card" id="card-rain" onclick="toggleSound('rain', 'card-rain')">
                <div class="icon">üåßÔ∏è</div>
                <div class="status-text">OFF</div>
                <div class="slider-wrapper" onclick="event.stopPropagation()">
                    <input type="range" min="0" max="1" step="0.01" value="0.5" oninput="setVolume('rain', this.value)">
                </div>
                <audio id="rain" loop preload="auto" src="sounds/rain_sounds.mp3"></audio>
            </div>

            <div class="sound-card" id="card-birds" onclick="toggleSound('birds', 'card-birds')">
                <div class="icon">ü¶ú</div>
                <div class="status-text">OFF</div>
                <div class="slider-wrapper" onclick="event.stopPropagation()">
                    <input type="range" min="0" max="1" step="0.01" value="0.5"
                        oninput="setVolume('birds', this.value)">
                </div>
                <audio id="birds" loop preload="auto" src="sounds/bird_sounds.mp3"></audio>
            </div>

            <div class="sound-card" id="card-water" onclick="toggleSound('water', 'card-water')">
                <div class="icon">üåä</div>
                <div class="status-text">OFF</div>
                <div class="slider-wrapper" onclick="event.stopPropagation()">
                    <input type="range" min="0" max="1" step="0.01" value="0.5"
                        oninput="setVolume('water', this.value)">
                </div>
                <audio id="water" loop preload="auto" src="sounds/wave_sounds.mp3"></audio>
            </div>

            <div class="sound-card" id="card-brown" onclick="toggleSound('brown', 'card-brown')">
                <div class="icon">üìª</div>
                <div class="status-text">OFF</div>
                <div class="slider-wrapper" onclick="event.stopPropagation()">
                    <input type="range" min="0" max="1" step="0.01" value="0.5"
                        oninput="setVolume('brown', this.value)">
                </div>
                <audio id="brown" loop preload="auto" src="sounds/brown_noise.mp3"></audio>
            </div>

        </div>

        <div class="game-container" id="view-game">
            <canvas id="gameCanvas" width="600" height="400"></canvas>
            <div class="game-overlay" id="game-start-msg">Press SPACE to Start</div>
            <div class="game-score">
                Score: <span id="score-display">0</span>
                <span id="high-score-wrapper" style="margin-left: 20px; font-size: 0.8em; color: #fff;">High Score:
                    <span id="high-score-display">0</span></span>
                <div id="wave-display" style="font-size: 0.8em; color: #ff00ff; margin-top:5px;">WAVE 1</div>
            </div>

            <!-- Touch Controls -->
            <div class="mobile-controls">
                <div class="control-btn" ontouchstart="setKey('ArrowLeft', true); event.preventDefault()"
                    ontouchend="setKey('ArrowLeft', false); event.preventDefault()">‚Üê</div>
                <div class="control-btn fire-btn" ontouchstart="handleMobileFire(); event.preventDefault()">üî•</div>
                <div class="control-btn" ontouchstart="setKey('ArrowRight', true); event.preventDefault()"
                    ontouchend="setKey('ArrowRight', false); event.preventDefault()">‚Üí</div>
            </div>
        </div>

        <!-- Breathing Exercise View -->
        <div class="breathing-container" id="view-breathing" style="display: none;">
            <div class="breath-circle-container">
                <div class="breath-circle"></div>
                <div class="breath-text" id="breath-instruction">Ready?</div>
            </div>
            <div class="breath-subtext">Follow the circle...</div>
        </div>

        <!-- Statistics View -->
        <div class="stats-container" id="view-stats">
            <div class="stats-header">
                <h2>Productivity Insights</h2>
                <div class="stats-cards">
                    <div class="stat-card">
                        <div class="stat-value" id="total-sessions-stat">0</div>
                        <div class="stat-label">Total Sessions</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-value" id="best-streak-stat">0</div>
                        <div class="stat-label">Best Streak (Days)</div>
                    </div>
                </div>
            </div>

            <div class="stats-viz">
                <canvas id="statsCanvas" width="600" height="600"></canvas>
            </div>

            <div class="stats-legend">
                <p style="text-align: center; color: #888; font-size: 0.85rem;">
                    Hourly distribution of completed work sessions
                </p>
            </div>

            <div class="stats-actions">
                <button onclick="exportStats()">Export Data</button>
                <button onclick="resetStats()">Clear History</button>
            </div>
        </div>

        <button class="stop-all-btn" onclick="stopAllSounds()">Shutdown Audio</button>

    </div>

    <!-- Date Time Display -->
    <div class="datetime-display" id="datetime-container">
        <div class="dt-location" id="dt-location">
            <button class="location-btn" onclick="fetchLocation()">Enable Location</button>
        </div>

        <div class="dt-time" id="dt-time">00:00:00</div>
        <div class="dt-date" id="dt-date">Loading...</div>
    </div>

    <!-- Sticky Notes Logic -->
    <div id="sticky-notes-container"></div>

    <div class="note-colors-menu" id="note-colors-menu">
        <div class="color-option" style="background:#ffeb3b" onclick="addNote('#ffeb3b')"></div>
        <div class="color-option" style="background:#a7ffeb" onclick="addNote('#a7ffeb')"></div>
        <div class="color-option" style="background:#ccff90" onclick="addNote('#ccff90')"></div>
        <div class="color-option" style="background:#f48fb1" onclick="addNote('#f48fb1')"></div>
        <div class="color-option" style="background:#80d8ff" onclick="addNote('#80d8ff')"></div>
    </div>

    <button class="add-note-fab" onclick="toggleColorMenu()">+ NOTE</button>

    <script src="script.js"></script>
</body>

</html>